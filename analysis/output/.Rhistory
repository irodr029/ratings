vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)
vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = reg_data))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(what  = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(what  = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def), data = .)
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(what  = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def), data = .)
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do( .data = ., .f = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(.f = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(model = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(what  = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(what  = vif, lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = reg_data))
test <- vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = reg_data))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(as.data.frame(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
test <- as.data.frame(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = reg_data)))
View(test)
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(model = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(model))
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def)))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do_(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
#do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
cds_macro
cds_macro[[1]]
cds_macro[[2]]
cds_macro[[3]]
cds_macro <- group_by(reg_data, agency, year) %>%
#do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
test1 <- group_by(reg_data, agency, year) %>%
do(vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
test1 <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
View(test1)
test1[[3]]
print(test1)
#Check for multicollinearity using VIF (only checking for average rating across time)
reg_results_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .)))
cds_macro_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
reg_results_vif[[3]]
reg_results_multCDS_vif[[3]]
cds_macro_vif[[3]]
stasrgazer(reg_results_vif[[3]], type = 'text')
stargazer(reg_results_vif[[3]], type = 'text')
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF')
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF - Cantor Packer (2007 - 2012)')
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF - Cantor Packer (2007 - 2012)', column.labels=c("2007","2008", "2009", "2010", "2011", "2012"))
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF - Cantor Packer (2007 - 2012)', table.labels=c("2007","2008", "2009", "2010", "2011", "2012"))
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF - Cantor Packer (2007 - 2012)', row.labels=c("2007","2008", "2009", "2010", "2011", "2012"))
stargazer(reg_results_vif[[3]], type = 'text', title = 'VIF - Cantor Packer (2007 - 2012)', out = 'vif_reg_results.txt')
stargazer(reg_results_multCDS_vif[[3]], type = 'text', title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
stargazer(cds_macro_vif[[3]], type = 'text', title = 'VIF - CDS on Macro Variable (2007 - 2012)', out = 'vif_cs_macro.txt')
cds_macro_vif[[1]]
cds_macro_vif[[2]]
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = as.data.table(vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .))))
reg_results_multCDS_vif
reg_results_multCDS_vif[[3]]
reg_results_multCDS_vif[[2]]
reg_results_multCDS_vif[[1]]
stargazer(reg_results_multCDS_vif[[1]], type = 'text', title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
stargazer(reg_results_multCDS_vif[[3]], type = 'text', title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .)))
stargazer(reg_results_multCDS_vif[[3]], type = 'text', title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
reg_results_multCDS_vif[[3]]
as.data.frame(reg_results_multCDS_vif[[3]])
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]]) %>%
rename(c('2007', '2008', '2009', '2010', '2011', '2012'))
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]])
View(reg_results_multCDS_vif)
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]]) %>%
rename(c('variables','2007', '2008', '2009', '2010', '2011', '2012'))
View(reg_results_multCDS_vif)
names(reg_results_multCDS_vif)
names(reg_results_multCDS_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
reg_results_multCDS_vif
stargazer(reg_results_multCDS_vif, type = 'text', title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - Multivariate w/ CDS spread (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - Multivariate w/ CDS spread using Avg. Rating (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
#VIF for CDS on Macro Variables using average ratings
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .)))
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]])
names(reg_results_multCDS_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - Multivariate w/ CDS spread using Avg. Rating (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
cds_macro_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
cds_macro_vif <- as.data.frame(cds_macro_vif[[3]])
names(cds_macro_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(cds_macro_vif, type = 'text', summary = FALSE,
title = 'VIF - CDS on Macro Variables using Avg. Rating (2007 - 2012)', out = 'vif_cs_macro.txt')
###########################
#Check for multicollinearity using VIF (only checking for average rating across time)
#VIF for CP replication over time using average ratings
reg_results_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
reg_results_vif <- as.data.frame(reg_results_vif[[3]])
names(reg_results_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - CP replication using Avg. Rating (2007 - 2012)', out = 'vif_reg_results.txt')
#VIF for CDS on Macro Variables using average ratings
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .)))
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]])
names(reg_results_multCDS_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - Multivariate w/ CDS spread using Avg. Rating (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
cds_macro_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
cds_macro_vif <- as.data.frame(cds_macro_vif[[3]])
names(cds_macro_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(cds_macro_vif, type = 'text', summary = FALSE,
title = 'VIF - CDS on Macro Variables using Avg. Rating (2007 - 2012)', out = 'vif_cs_macro.txt')
tbl_df(data)
data.plot <- tbl_df(data)
data.plot$year <- as.factor(data.plot$year)
str(data.plot)
ggpairs(reg_data, columns = 5:14, alpha = 0.05, colour = 'year')
str(data.plot)
ggpairs(reg_data, columns = 5:14, colour = 'year')
ggpairs(reg_data, columns = 5:14)
data.plot <- tbl_df(reg_data)
data.plot$year <- as.factor(data.plot$year)
str(data.plot)
ggpairs(reg_data, columns = 5:14, colour = 'year')
data.plot <- tbl_df(reg_data)
data.plot$year <- as.factor(data.plot$year)
str(data.plot)
ggpairs(reg_data, columns = 5:14, colour = 'year')
ggpairs(reg_data, columns = 5:7, colour = 'year')
ggpairs(reg_data, columns = 5:7, colour = 'year')
ggpairs(data.plot, columns = 5:7, colour = 'year')
ggpairs(data.plot, columns = 5:7, colour = 'year') + theme_bw()
ggpairs(data.plot, columns = 5:14, colour = 'year')
ggpairs(data.plot, columns = 5:14, colour = 'year', lower = list(continuous = "smooth"))
ggpairs(data.plot, columns = 5:14, colour = 'year', lower = list(continuous = "smooth", combo = "facetdensity"))
data.plot <- tbl_df(reg_data)
data.plot$year <- as.factor(data.plot$year)
data.plot$rating <- as.factor(data.plot$rating)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', lower = list(continuous = "smooth", combo = "facetdensity"))
View(data)
data.plot <- tbl_df(reg_data)
data.plot <- tbl_df(reg_data)
data.plot$year <- as.factor(data.plot$year)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "facetdensity"))
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "facethist"))
reg_corr <- group_by(reg_data, agency, year) %>%
do(correl = corr(.))
reg_corr <- group_by(reg_data, agency, year) %>%
do(correl = cor(.))
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "denstrip"))
data.plot <- tbl_df(complete.cases(reg_data))
data.plot$year <- as.factor(data.plot$year)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "denstrip"))
View(data.plot)
data.plot <- tbl_df(complete.cases(reg_data))
reg_data
complete.cases(reg_data)
data.plot <- tbl_df(reg_data[complete.cases(reg_data),])
data.plot <- tbl_df(reg_data[complete.cases(reg_data),])
data.plot$year <- as.factor(data.plot$year)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "dot"))
Plotting Average ratings
data.plot <- tbl_df(reg_data[complete.cases(reg_data),])
data.plot$year <- as.factor(data.plot$year)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "facethist"))
##########################
#Plotting Average ratings
data.plot <- tbl_df(reg_data[complete.cases(reg_data),])
data.plot$year <- as.factor(data.plot$year)
data.plot$def <- as.factor(data.plot$def)
data.plot$dev <- as.factor(data.plot$dev)
str(data.plot)
ggpairs(data.plot, columns = 5:14, colour = 'year', alpha = 0.20, lower = list(continuous = "smooth", combo = "facetdensity"))
cor(data.plot)
cor(data.plot[,5:14])
cor(data.plot[,5:12])
cor(reg_data[complete.cases(reg_data),5:14)
cor(reg_data[complete.cases(reg_data),5:14])
cor(reg_data[,5:14])
View(data)
#####Regression Data
#This script creates data for regging
#Packages for regression analysis and data manipulation
library('WDI')
library('reshape2')
library('dplyr')
library('lubridate')
library('data.table')
library('zoo')
library('car')
library('ggplot2')
library('GGally')
library('stargazer')
#Define input and output locations
loc_data_output <- "~/Desktop/Ratings/data/output"
loc_results_output <- "~/Desktop/Ratings/analysis/output"
#Read in regression file in working directory as data frame----
setwd(loc_data_output)
data <- read.csv('08_regdata.csv', sep = ',', stringsAsFactors=FALSE)
data <- data[complete.cases(data),]
##################################################################################
#Regression Analysis
setwd(loc_results_output)
###########################
##These results are only for the latest year (2012)
rep_data <- filter(data, year == 2012)
###Results - Replicate CP table using 2012
rep_results <- group_by(rep_data, agency, year) %>%
do(model = lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
stargazer(rep_results[[3]], title = 'Replication of CP (1996) - 2012 data', type = "text", column.labels=c("Avg","Diff", "Moody's", "S&P"), report = "vct*", out = "repl_2012.txt")
###Results - Crossectional Regressions by Agency only CDS using 2012
rep_results_uniCDS <- group_by(rep_data, agency, year) %>%
do(model = lm(rating ~  log(CDS), data = .))
stargazer(rep_results_uniCDS[[3]], title = 'Univariate Regression for 2012 - Ratings on CDS spread', type = "text", column.labels=c("Avg","Diff", "Moody's", "S&P"), report = "vct*", out = "repl_uniCDS.txt")
###Results - Replicate CP table using 2012 adding CDS
rep_results_multCDS <- group_by(rep_data, agency, year) %>%
do(model = lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .))
stargazer(rep_results_multCDS[[3]], title = 'Multivariate Regression including CDS spread - 2012 data', type = "text", column.labels=c("Avg","Diff", "Moody's", "S&P"), report = "vct*", out = "repl_multCDS.txt")
###########################
##These results are for all of the years (average ratings only)
##These results are only for the latest year (2012)
reg_data <- filter(data, agency == "Average")
###Results - Replicate CP table using average ratings across time
reg_results <- group_by(reg_data, agency, year) %>%
do(model = lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
stargazer(reg_results[[3]], title = 'Replication of CP (1996) Across Time - Average Rating', type = "text", column.labels=c("2007","2008", "2009", "2010", "2011", "2012"), report = "vct*", out = "reg_avg.txt")
###Results - Univariate regression (CDS) using average ratings across time
reg_results_uniCDS <- group_by(reg_data, agency, year) %>%
do(model = lm(rating ~ log(CDS), data = .))
stargazer(reg_results_uniCDS[[3]], title = 'Univariate Regressions Across Time - Average Rating on CDS spread', type = "text", column.labels=c("2007","2008", "2009", "2010", "2011", "2012"), report = "vct*", out = "reg_uniCDS.txt")
###Results - Replicate CP table using average ratings across time
reg_results_multCDS <- group_by(reg_data, agency, year) %>%
do(model = lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .))
stargazer(reg_results_multCDS[[3]], title = 'Multivariate Regressions Across Time Including CDS spread - Average Rating ', type = "text", column.labels=c("2007","2008", "2009", "2010", "2011", "2012"), report = "vct*", out = "reg_multCDS.txt")
###########################
#CDS spread on Macro Variables
cds_macro <- group_by(reg_data, agency, year) %>%
do(model = lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .))
stargazer(cds_macro[[3]], title = 'Multivariate Regressions Across Time (CDS on Macro variables) - Average Rating ', type = "text", column.labels=c("2007","2008", "2009", "2010", "2011", "2012"), report = "vct*", out = "cds_macro.txt")
###########################
#Check for multicollinearity using VIF (only checking for average rating across time)
#VIF for CP replication over time using average ratings
reg_results_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
reg_results_vif <- as.data.frame(reg_results_vif[[3]])
names(reg_results_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - CP replication using Avg. Rating (2007 - 2012)', out = 'vif_reg_results.txt')
#VIF for CDS on Macro Variables using average ratings
reg_results_multCDS_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(rating ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def + log(CDS), data = .)))
reg_results_multCDS_vif <- as.data.frame(reg_results_multCDS_vif[[3]])
names(reg_results_multCDS_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(reg_results_multCDS_vif, type = 'text', summary = FALSE,
title = 'VIF - Multivariate w/ CDS spread using Avg. Rating (2007 - 2012)', out = 'vif_reg_results_multCDS.txt')
cds_macro_vif <- group_by(reg_data, agency, year) %>%
do(vif = vif(lm(log(CDS) ~ log(GNI_cap) + GDP_grw + log(inf) + fsc_bal + ext_bal + ext_dbt + dev + def, data = .)))
cds_macro_vif <- as.data.frame(cds_macro_vif[[3]])
names(cds_macro_vif) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(cds_macro_vif, type = 'text', summary = FALSE,
title = 'VIF - CDS on Macro Variables using Avg. Rating (2007 - 2012)', out = 'vif_cs_macro.txt')
View(reg_data)
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency) %>%
do(correl = corr(.))
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency) %>%
do(correl = cor(.))
correl_data
correl_data[[2]]
#Correlations
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year) %>%
do(correl = cor(.))
correl_data[[2]]
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year) %>%
do(correl = cor(.))
correl_data[[2]]
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year)
correl_data
correl_data[[2]]
correl_data[[2]]
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year) %>%
do(correl = cor(.))
correl_data[[2]]
correl_data[[1]]
correl_data[[2]]
stargazer(correl_data[[2]], type = 'text', summary = FALSE)
stargazer(correl_data[[2]], type = 'text')
correl <- stargazer(correl_data[[2]], type = 'text')
str(correl)
correl
stargazer(correl_data[[2]], type = 'text')
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year)
correl <- do(correl = cor(crrel_data[,2:11]))
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year)
correl <- do(correl = cor(correl_data[,2:11]))
correl <- do(correl = cor(correl_data[,2:10]))
correl <- do(correl = cor(correl_data[,1:10]))
correl <- do(correl = cor(correl_data))
correl <- do(correl_data, correl = cor(.))
View(correl)
stargazer(correl[[2]], type = 'text')
correl <- do(correl_data[,2:11], correl = cor(.))
correl <- do(select(correl_data,-year), correl = cor(.))
stargazer(correl[[2]], type = 'text')
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year) %>%
do(correl = cor(.))
stargazer(correl_data[[2]], type = 'text')
names(correl_data[[2]])
names(correl_data[[2]]) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(correl_data[[2]], type = 'text')
correl_data[[2]]
stargazer(correl_data[[2]], type = 'text')
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year, -rating) %>%
do(correl = cor(.))
correl_data[[2]]
#Correlations
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year, -rating) %>%
do(correl = cor(.))
names(correl_data[[2]]) <- c('2007', '2008', '2009', '2010', '2011', '2012')
correl_data[[2]]
stargazer(correl_data[[2]], object.names = TRUE, summary = FALSE,
title = 'Correlation Matrix')
stargazer(correl_data[[2]], object.names = TRUE, summary = FALSE, type = 'text'
title = 'Correlation Matrix')
stargazer(correl_data[[2]], object.names = TRUE, summary = FALSE, type = 'text',
title = 'Correlation Matrix')
stargazer(correl_data[[2]], object.names = TRUE, type = 'text',
title = 'Correlation Matrix')
stargazer(correl_data[[2]], object.names = TRUE, type = 'text')
correl_data <- group_by(reg_data, year) %>% select(-iso2c, -country, -agency, -year, -rating) %>%
do(correl = cor(.))
names(correl_data[[2]]) <- c('2007', '2008', '2009', '2010', '2011', '2012')
stargazer(correl_data[[2]], object.names = TRUE, type = 'text')
stargazer(correl_data[[2]], keep.names = TRUE, type = 'text'), out = 'correl_year.txt')
stargazer(correl_data[[2]], keep.names = TRUE, type = 'text')
stargazer(correl_data[[2]], object.names = FALSE, type = 'text')
stargazer(correl_data[[2]], object.names = TRUE, type = 'text', title = "Correlation"), out = 'correl_year.txt')
stargazer(correl_data[[2]], object.names = TRUE, type = 'text', title = "Correlation")
correl_data[[2]]
stargazer(correl_data[[2]], object.names = TRUE, type = 'text', title = "Correlation", out.header = TRUE)
stargazer(correl_data[[2]], object.names = TRUE, type = 'text', title = "Correlation", dep.var.labels.include = TRUE)
stargazer(correl_data[[2]], object.names = TRUE, type = 'text', title = "Correlation", dep.var.labels.include = TRUE)
names(stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.txt'))
names(stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.txt')) <- c('2007', '2008', '2009', '2010', '2011', '2012')
names(stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.txt')) <- c('2007', '2008', '2009', '2010', '2011', '2012')
names(stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.txt'))
stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.xls')
cor(select(reg_data, -iso2c, -country, -agency, -year, -rating))
stargazer(correl_data[[2]], type = 'text', title = "Correlation",out = 'correl_year.txt')
stargazer(cor(select(reg_data, -iso2c, -country, -agency, -year, -rating)), type = 'text', title = "Correlation",out = 'correl.txt')
as.data.frame(correl_data[[2]])
stargazer(as.data.frame(correl_data[[2]]), type = "text")
stargazer(as.data.frame(correl_data[[2]]), type = "text", title = "Correlation",out = 'correl_test.txt')
stargazer(as.data.frame(correl_data[[2]]), type = "text", summary = FALSE, title = "Correlation",out = 'correl_test.txt')
view(as.data.frame(correl_data[[2]]))
view(as.data.frame(correl_data[[2]]))
View(correl)
View(as.data.frame(correl_data[[2]]))
library('stats')
library('Hmisc')
install.packages("Hmisc")
library('Hmisc')
cormatrix = rcorr(as.matrix(select(reg_data, -iso2c, -country, -agency, -year, -rating)), type='spearman')
cormatrix = rcorr(as.matrix(select(reg_data, -iso2c, -country, -agency, -year, -rating)), type='pearson')
cormatrix
abbreviateSTR <- function(value, prefix){  # format string more concisely
lst = c()
for (item in value) {
if (is.nan(item) || is.na(item)) { # if item is NaN return empty string
lst <- c(lst, '')
next
}
item <- round(item, 2) # round to two digits
if (item == 0) { # if rounding results in 0 clarify
item = '<.01'
}
item <- as.character(item)
item <- sub("(^[0])+", "", item)    # remove leading 0: 0.05 -> .05
item <- sub("(^-[0])+", "-", item)  # remove leading -0: -0.05 -> -.05
lst <- c(lst, paste(prefix, item, sep = ""))
}
return(lst)
}
d <- select(reg_data, -iso2c, -country, -agency, -year, -rating)
cormatrix = rcorr(as.matrix(d), type='spearman')
cordata = melt(cormatrix$r)
cordata$labelr = abbreviateSTR(melt(cormatrix$r)$value, 'r')
cordata$labelP = abbreviateSTR(melt(cormatrix$P)$value, 'P')
cordata$label = paste(cordata$labelr, "\n",
cordata$labelP, sep = "")
cordata$strike = ""
cordata$strike[cormatrix$P > 0.05] = "X"
txtsize <- par('din')[2] / 2
ggplot(cordata, aes(x=Var1, y=Var2, fill=value)) + geom_tile() +
theme(axis.text.x = element_text(angle=90, hjust=TRUE)) +
xlab("") + ylab("") +
geom_text(label=cordata$label, size=txtsize) +
geom_text(label=cordata$strike, size=txtsize * 4, color="red", alpha=0.4)
##Correlation Plot - Overall
abbreviateSTR <- function(value, prefix){  # format string more concisely
lst = c()
for (item in value) {
if (is.nan(item) || is.na(item)) { # if item is NaN return empty string
lst <- c(lst, '')
next
}
item <- round(item, 2) # round to two digits
if (item == 0) { # if rounding results in 0 clarify
item = '<.01'
}
item <- as.character(item)
item <- sub("(^[0])+", "", item)    # remove leading 0: 0.05 -> .05
item <- sub("(^-[0])+", "-", item)  # remove leading -0: -0.05 -> -.05
lst <- c(lst, paste(prefix, item, sep = ""))
}
return(lst)
}
d <- select(reg_data, -iso2c, -country, -agency, -year, -rating)
cormatrix = rcorr(as.matrix(d), type='pearson')
cordata = melt(cormatrix$r)
cordata$labelr = abbreviateSTR(melt(cormatrix$r)$value, 'r')
cordata$labelP = abbreviateSTR(melt(cormatrix$P)$value, 'P')
cordata$label = paste(cordata$labelr, "\n",
cordata$labelP, sep = "")
cordata$strike = ""
cordata$strike[cormatrix$P > 0.05] = "X"
txtsize <- par('din')[2] / 2
ggplot(cordata, aes(x=Var1, y=Var2, fill=value)) + geom_tile() +
theme(axis.text.x = element_text(angle=90, hjust=TRUE)) +
xlab("") + ylab("") +
geom_text(label=cordata$label, size=txtsize) +
geom_text(label=cordata$strike, size=txtsize * 4, color="red", alpha=0.4)
